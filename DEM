// 1. استدعاء منطقة الدراسة (شيب فايل النجف) من مسارك الخاص
var najaf_roi = ee.FeatureCollection("projects/moh-proj/assets/Najaf-shp");

// 2. استدعاء بيانات Copernicus Global DEM (GLO-30)
// ملاحظة: هذه البيانات تعتبر الأدق حالياً للارتفاعات العالمية المجانية
var dataset = ee.ImageCollection("COPERNICUS/DEM/GLO30")
                  .select('DEM')
                  .filterBounds(najaf_roi);

// 3. دمج الصور وقصها على حدود النجف بدقة
var elevation = dataset.mean().clip(najaf_roi);

// 4. إعدادات العرض (للمعاينة على الخريطة فقط)
var visParams = {
  min: 0,
  max: 200, // الارتفاعات التقريبية في النجف، يمكنك تعديلها
  palette: ['#0000ff', '#00ffff', '#ffff00', '#ff0000', '#ffffff']
};

// 5. عرض النتيجة على الخريطة
Map.centerObject(najaf_roi, 8);
Map.addLayer(elevation, visParams, 'Copernicus DEM - Najaf');
Map.addLayer(najaf_roi, {color: 'red'}, 'Najaf Boundary', false);

// 6. أمر التصدير إلى Google Drive
Export.image.toDrive({
  image: elevation,
  description: 'Copernicus_DEM_Najaf_30m',
  scale: 30,               // الدقة المكانية 30 متر
  region: najaf_roi.geometry().bounds(), // حدود منطقة التحميل
  fileFormat: 'GeoTIFF',    // الصيغة المناسبة لـ ENVI و ArcGIS
  maxPixels: 1e13,
  formatOptions: {
    cloudOptimized: true   // يجعل الملف أسرع عند فتحه في برامج الـ GIS
  }
});

// طباعة تأكيد في الـ Console
print('تم تجهيز ملف Copernicus DEM للنجف، يرجى الضغط على Run في تبويب Tasks للتحميل.');